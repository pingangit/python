python 打包
==========

# 1. 打包成 .tar.gz
```
dbo@dbo-pc:~/temp$ pwd
/home/dbo/temp
dbo@dbo-pc:~/temp$ cat setup.py 
from distutils.core import setup
setup(name='machine_load',
      version='1.0',
      py_modules=['machine_load'],
      )
dbo@dbo-pc:~/temp$ 

dbo@dbo-pc:~/temp$ ls -ltr
总用量 4
-rwxrwxr-x 1 dbo dbo 1924 10月 21 22:20 machine_load.py
dbo@dbo-pc:~/temp$

dbo@dbo-pc:~/temp$ python setup.py sdist
running sdist
running check
warning: check: missing required meta-data: url

warning: check: missing meta-data: either (author and author_email) or (maintainer and maintainer_email) must be supplied

warning: sdist: manifest template 'MANIFEST.in' does not exist (using default file list)

warning: sdist: standard file not found: should have one of README, README.txt

writing manifest file 'MANIFEST'
creating machine_load-1.0
making hard links in machine_load-1.0...
hard linking machine_load.py -> machine_load-1.0
hard linking setup.py -> machine_load-1.0
creating dist
Creating tar archive
removing 'machine_load-1.0' (and everything under it)
dbo@dbo-pc:~/temp$ ls -l
总用量 16
drwxrwxr-x 2 dbo dbo 4096 10月 21 22:21 dist
-rwxrwxr-x 1 dbo dbo 1924 10月 21 22:20 machine_load.py
-rw-rw-r-- 1 dbo dbo   68 10月 21 22:21 MANIFEST
-rw-rw-r-- 1 dbo dbo  124 10月 21 22:21 setup.py
dbo@dbo-pc:~/temp$ more MANIFEST 
# file GENERATED by distutils, do NOT edit
machine_load.py
setup.py
dbo@dbo-pc:~/temp$ 

# 这里看到已经生成了 .tar.gz 包
dbo@dbo-pc:~/temp$ ls -l dist/
总用量 4
-rw-rw-r-- 1 dbo dbo 1112 10月 21 22:21 machine_load-1.0.tar.gz
dbo@dbo-pc:~/temp$ 
```
# 2. 打包成 rpm
```
dbo@dbo-pc:~/temp$ python setup.py bdist_rpm
running bdist_rpm
writing 'build/bdist.linux-x86_64/rpm/SPECS/machine_load.spec'
running sdist
running check
warning: check: missing required meta-data: url

warning: check: missing meta-data: either (author and author_email) or (maintainer and maintainer_email) must be supplied

warning: sdist: manifest template 'MANIFEST.in' does not exist (using default file list)

warning: sdist: standard file not found: should have one of README, README.txt

writing manifest file 'MANIFEST'
creating machine_load-1.0
making hard links in machine_load-1.0...
hard linking machine_load.py -> machine_load-1.0
hard linking setup.py -> machine_load-1.0
Creating tar archive
removing 'machine_load-1.0' (and everything under it)
copying dist/machine_load-1.0.tar.gz -> build/bdist.linux-x86_64/rpm/SOURCES
building RPMs
rpmbuild -ba --define _topdir /home/dbo/temp/build/bdist.linux-x86_64/rpm --clean build/bdist.linux-x86_64/rpm/SPECS/machine_load.spec
执行(%prep): /bin/sh -e /var/tmp/rpm-tmp.kjl4G2
+ umask 022
+ cd /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILD
+ cd /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILD
+ rm -rf machine_load-1.0
+ /bin/gzip -dc /home/dbo/temp/build/bdist.linux-x86_64/rpm/SOURCES/machine_load-1.0.tar.gz
+ /bin/tar -xvvf -
drwxrwxr-x dbo/dbo           0 2016-10-21 22:24 machine_load-1.0/
-rw-rw-r-- dbo/dbo         184 2016-10-21 22:24 machine_load-1.0/PKG-INFO
-rw-rw-r-- dbo/dbo         124 2016-10-21 22:21 machine_load-1.0/setup.py
-rwxrwxr-x dbo/dbo        1924 2016-10-21 22:20 machine_load-1.0/machine_load.py
+ STATUS=0
+ [ 0 -ne 0 ]
+ cd machine_load-1.0
+ /bin/chmod -Rf a+rX,u+w,g-w,o-w .
+ exit 0
执行(%build): /bin/sh -e /var/tmp/rpm-tmp.eFYx87
+ umask 022
+ cd /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILD
+ cd machine_load-1.0
+ python setup.py build
running build
running build_py
creating build
creating build/lib.linux-x86_64-2.7
copying machine_load.py -> build/lib.linux-x86_64-2.7
+ exit 0
执行(%install): /bin/sh -e /var/tmp/rpm-tmp.lCFFLd
+ umask 022
+ cd /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILD
+ cd machine_load-1.0
+ python setup.py install -O1 --root=/home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64 --record=INSTALLED_FILES
running install
running build
running build_py
running install_lib
creating /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64
creating /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64/usr
creating /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64/usr/local
creating /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64/usr/local/lib
creating /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64/usr/local/lib/python2.7
creating /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64/usr/local/lib/python2.7/dist-packages
copying build/lib.linux-x86_64-2.7/machine_load.py -> /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64/usr/local/lib/python2.7/dist-packages
byte-compiling /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64/usr/local/lib/python2.7/dist-packages/machine_load.py to machine_load.pyc
writing byte-compilation script '/tmp/tmp1D6Opq.py'
/usr/bin/python -O /tmp/tmp1D6Opq.py
removing /tmp/tmp1D6Opq.py
running install_egg_info
Writing /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64/usr/local/lib/python2.7/dist-packages/machine_load-1.0.egg-info
writing list of installed files to 'INSTALLED_FILES'
+ /usr/lib/rpm/brp-compress
+ /usr/lib/rpm/brp-strip /usr/bin/strip
+ /usr/lib/rpm/brp-strip-static-archive /usr/bin/strip
+ /usr/lib/rpm/brp-strip-comment-note /usr/bin/strip /usr/bin/objdump
处理文件：machine_load-1.0-1.noarch
Provides: machine_load = 1.0-1
Requires(rpmlib): rpmlib(CompressedFileNames) <= 3.0.4-1 rpmlib(PayloadFilesHavePrefix) <= 4.0-1
检查未打包文件：/usr/lib/rpm/check-files /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64
已写至：/home/dbo/temp/build/bdist.linux-x86_64/rpm/SRPMS/machine_load-1.0-1.src.rpm
已写至：/home/dbo/temp/build/bdist.linux-x86_64/rpm/RPMS/noarch/machine_load-1.0-1.noarch.rpm
执行(%clean): /bin/sh -e /var/tmp/rpm-tmp.WQjbIl
+ umask 022
+ cd /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILD
+ cd machine_load-1.0
+ rm -rf /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILDROOT/machine_load-1.0-1.x86_64
+ exit 0
执行(--clean): /bin/sh -e /var/tmp/rpm-tmp.VWN1Et
+ umask 022
+ cd /home/dbo/temp/build/bdist.linux-x86_64/rpm/BUILD
+ rm -rf machine_load-1.0
+ exit 0
moving build/bdist.linux-x86_64/rpm/SRPMS/machine_load-1.0-1.src.rpm -> dist
moving build/bdist.linux-x86_64/rpm/RPMS/noarch/machine_load-1.0-1.noarch.rpm -> dist
dbo@dbo-pc:~/temp$ ls -ltr
总用量 20
-rwxrwxr-x 1 dbo dbo 1924 10月 21 22:20 machine_load.py
-rw-rw-r-- 1 dbo dbo  124 10月 21 22:21 setup.py
drwxrwxr-x 3 dbo dbo 4096 10月 21 22:23 build
-rw-rw-r-- 1 dbo dbo   68 10月 21 22:24 MANIFEST
drwxrwxr-x 2 dbo dbo 4096 10月 21 22:24 dist
dbo@dbo-pc:~/temp$ 

# 这里看到已经生成了 rpm 包
dbo@dbo-pc:~/temp$ ls -l dist/
总用量 20
-rw-rw-r-- 1 dbo dbo 8020 10月 21 22:24 machine_load-1.0-1.noarch.rpm
-rw-rw-r-- 1 dbo dbo 7163 10月 21 22:24 machine_load-1.0-1.src.rpm
-rw-rw-r-- 1 dbo dbo 1113 10月 21 22:24 machine_load-1.0.tar.gz
dbo@dbo-pc:~/temp$ 
```